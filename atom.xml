<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://www.cxlsky.com</id>
    <title>longlongago</title>
    <updated>2022-10-20T08:49:22.296Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://www.cxlsky.com"/>
    <link rel="self" href="https://www.cxlsky.com/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://www.cxlsky.com/images/avatar.png</logo>
    <icon>https://www.cxlsky.com/favicon.ico</icon>
    <rights>All rights reserved 2022, longlongago</rights>
    <entry>
        <title type="html"><![CDATA[Cloud Dragon é¡¹ç›®ä»‹ç»]]></title>
        <id>https://www.cxlsky.com/post/cloud-dragon-xiang-mu-jie-shao/</id>
        <link href="https://www.cxlsky.com/post/cloud-dragon-xiang-mu-jie-shao/">
        </link>
        <updated>2021-06-14T10:38:41.000Z</updated>
        <content type="html"><![CDATA[<p><img src="https://www.cxlsky.com/post-images/1666250871443.png" alt="" loading="lazy">Cloud Dragon æ˜¯ä¸€å¥—é€‚åˆäºä¼ä¸šçº§ä½¿ç”¨çš„å¾®æœåŠ¡è„šæ‰‹æ¶é¡¹ç›®ï¼Œå¯ä»¥å¸®åŠ©å¿«é€Ÿæ„å»ºå¾®æœåŠ¡æ¶æ„ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œ åç«¯ä¸»è¦ä»¥ Spring Cloud Alibaba &amp; Nacos ä¸ºä¸»ï¼Œå‰ç«¯ä¸»è¦ä»¥ Vue &amp; Element-UI<br>
ä¸ºä¸»ã€‚</p>
<p align="center">
        <img src="https://oss.gagajiankang.com/cloud/logo.png" width="40px" syt height="40px" />
</p>
<p align="center">
        <strong>äº‘é¾™ Cloud Dragon</strong>
</p>
<p align="center">
	<strong>é€‚åˆäºä¼ä¸šçº§åˆ«çš„å¾®æœåŠ¡å¼€å‘è„šæ‰‹æ¶ï¼ŒåŠŸèƒ½é½å…¨ï¼Œå¼€ç®±å³ç”¨ï¼Œéƒ¨ç½²å¿«æ·</strong>
</p>
<p align="center">
	<a target="_blank" href="https://gitter.im/dragon_cloud/community?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge">
		<img src="https://badges.gitter.im/dragon_cloud/community.svg" />
	</a>
    <a target="_blank" href="https://opensource.org/licenses/Apache-2.0">
		<img src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" />
	</a>
	<a target="_blank" href="https://travis-ci.org/cxl-sky/cloud-dragon">
		<img src="https://travis-ci.org/cxl-sky/cloud-dragon.svg?branch=master" />
	</a>
    <a target="_blank" href="https://qm.qq.com/cgi-bin/qm/qr?k=gQw2MJysfnRTy9qKf8hWnK-xB24c__Dj&authKey=pxIxNHae0uFqcQenxT72xKQ3Isz3Xt5p9J+d2RCUPr2HaqLv+KElTKavXBPvgKsj&noverify=0">
		<img src="https://img.shields.io/badge/QQ%E7%BE%A4-878510003-blue" />
	</a>
    <a target="_blank" href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">
		<img src="https://img.shields.io/badge/JDK-8+-green.svg" />
	</a>
	<a target="_blank" href="https://spring.io/projects/spring-boot">
		<img src="https://img.shields.io/badge/spring%20boot-2.2.5-yellowgreen" />
	</a>
</p>
<hr>
<blockquote>
<p>ç›®å‰é¡¹ç›®å¤„äºå¼€å‘é˜¶æ®µï¼Œéƒ¨åˆ†åŠŸèƒ½å·²ç»å¯ä»¥ä½¿ç”¨ï¼Œåç»­ä¼šé€æ­¥å®Œæˆå…¶ä»–è§„åˆ’å†…å®¹ï¼Œå¹¶å®Œå–„é¡¹ç›®æ–‡æ¡£ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ QQ ç¾¤èŠè”ç³»æˆ‘ï¼Œ<a href="https://qm.qq.com/cgi-bin/qm/qr?k=gQw2MJysfnRTy9qKf8hWnK-xB24c__Dj&amp;authKey=pxIxNHae0uFqcQenxT72xKQ3Isz3Xt5p9J+d2RCUPr2HaqLv+KElTKavXBPvgKsj&amp;noverify=0">è¯·æˆ³è¿™é‡Œ</a> åŠ å…¥ç¾¤èŠã€‚</p>
</blockquote>
<h2 id="é¡¹ç›®ä»‹ç»">ğŸ“š é¡¹ç›®ä»‹ç»</h2>
<p>Cloud Dragon æ˜¯ä¸€å¥—é€‚åˆäºä¼ä¸šçº§ä½¿ç”¨çš„å¾®æœåŠ¡è„šæ‰‹æ¶é¡¹ç›®ï¼Œå¯ä»¥å¸®åŠ©å¿«é€Ÿæ„å»ºå¾®æœåŠ¡æ¶æ„ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œ åç«¯ä¸»è¦ä»¥ Spring Cloud Alibaba &amp; Nacos ä¸ºä¸»ï¼Œå‰ç«¯ä¸»è¦ä»¥ Vue &amp; Element-UI<br>
ä¸ºä¸»ã€‚</p>
<p>Cloud Dragon ä½¿ç”¨ Oauth2 è¿›è¡Œè®¤è¯æˆæƒç®¡ç†ï¼Œé‡‡ç”¨ JWT + Redis çš„æ–¹å¼æ§åˆ¶ä»¤ç‰Œå‘æ”¾ä¸é”€æ¯ã€‚ ç»Ÿä¸€ä½¿ç”¨ Docker<br>
éƒ¨ç½²ï¼Œæä¾›ä¸€é”®è„šæœ¬å®‰è£…ï¼Œå¿«é€Ÿéƒ¨ç½²ä½¿ç”¨ã€‚æ”¯æŒä¸€é”®å¿«é€Ÿç”Ÿæˆå‰åç«¯ä»£ç ï¼Œæé«˜å¼€å‘å¼€å‘æ•ˆç‡ï¼Œåªéœ€ä¸“æ³¨äºä¸šåŠ¡ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é€‚ç”¨çš„å¾®æœåŠ¡å¿«é€Ÿå¼€å‘è„šæ‰‹æ¶ã€‚</p>
<ul>
<li><a href="https://github.com/cxl-sky/cloud-dragon">é¡¹ç›®åœ°å€æˆ³è¿™é‡Œï¼Œè®°å¾— Star æ”¯æŒä¸€ä¸‹å“¦</a></li>
<li><a href="https://github.com/cxl-sky/cloud-dragon/blob/master/docs/quick-start.md">10 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹</a></li>
</ul>
<h2 id="ä¸»è¦åŠŸèƒ½åŠè§„åˆ’">ä¸»è¦åŠŸèƒ½åŠè§„åˆ’</h2>
<h3 id="1-ä¸»è¦æŠ€æœ¯æ ˆåŠè§„åˆ’">1. ä¸»è¦æŠ€æœ¯æ ˆåŠè§„åˆ’ï¼š</h3>
<table>
<thead>
<tr>
<th>æœåŠ¡</th>
<th>ä½¿ç”¨æŠ€æœ¯</th>
<th>è¿›åº¦</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ³¨å†Œä¸­å¿ƒ</td>
<td>Nacos</td>
<td>âœ…</td>
<td></td>
</tr>
<tr>
<td>é…ç½®ä¸­å¿ƒ</td>
<td>Nacos</td>
<td>âœ…</td>
<td></td>
</tr>
<tr>
<td>æ¶ˆæ¯ä¸­å¿ƒ</td>
<td>Spring Cloud Stream + Rabbitmq</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>åŠ¨æ€ç½‘å…³</td>
<td>Spring Cloud Gateway</td>
<td>âœ…</td>
<td>å¤šç§ç»´åº¦çš„æµé‡æ§åˆ¶ï¼ˆæœåŠ¡ã€IPã€ç”¨æˆ·ç­‰ï¼‰ï¼Œåç«¯å¯é…ç½®åŒ–</td>
</tr>
<tr>
<td>è®¤è¯ä¸­å¿ƒ</td>
<td>Spring Cloud Security OAuth2</td>
<td>âœ…</td>
<td>å‘æ”¾ Token æœåŠ¡ï¼ˆJWTï¼‰</td>
</tr>
<tr>
<td>æˆæƒè®¤è¯</td>
<td>Spring Cloud Security OAuth2</td>
<td>âœ…</td>
<td>æ ¹æ® Token åˆ¤æ–­æƒé™æœåŠ¡</td>
</tr>
<tr>
<td>æœåŠ¡å®¹é”™</td>
<td>Spring Cloud Sentinel</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>æœåŠ¡è°ƒç”¨</td>
<td>Spring Cloud OpenFeign</td>
<td>âœ…</td>
<td></td>
</tr>
<tr>
<td>å¯¹è±¡å­˜å‚¨</td>
<td>Minio</td>
<td>âœ…</td>
<td></td>
</tr>
<tr>
<td>ä»»åŠ¡è°ƒåº¦</td>
<td>XXL-Job</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>åˆ†åº“åˆ†è¡¨</td>
<td>Sharding Sphere</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>æ•°æ®æƒé™</td>
<td>Mybatis Plus</td>
<td>ğŸ—</td>
<td>å¯¹åŸæŸ¥è¯¢åšå¢å¼ºï¼Œä¸šåŠ¡ä»£ç ä¸ç”¨æ§åˆ¶ï¼Œå³å¯å®ç°ã€‚</td>
</tr>
<tr>
<td>ä»£ç ç”Ÿæˆ</td>
<td></td>
<td>ğŸ—50%ï¼ˆåç«¯ä»£ç ç”Ÿæˆå®Œæˆï¼Œå‰ç«¯ä»£ç ç”Ÿæˆè¿›è¡Œä¸­ï¼‰</td>
<td>å‰åç«¯ä»£ç çš„ç”Ÿæˆï¼Œæ”¯æŒVue</td>
</tr>
<tr>
<td>æ–‡æ¡£ç®¡ç†</td>
<td>Swagger2</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>æœåŠ¡ç›‘æ§</td>
<td>Spring Boot Admin</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>é“¾è·¯è¿½è¸ª</td>
<td>SkyWalking</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>æ“ä½œå®¡è®¡</td>
<td></td>
<td>ğŸ—</td>
<td>ç³»ç»Ÿå…³é”®æ“ä½œæ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢</td>
</tr>
<tr>
<td>æ—¥å¿—ç®¡ç†</td>
<td>ES + Kibana + Logstash</td>
<td>ğŸ—</td>
<td>ELK</td>
</tr>
<tr>
<td>ç›‘æ§å‘Šè­¦</td>
<td>Grafana</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>æŒç»­é›†æˆä¸éƒ¨ç½²</td>
<td>Jenkins + Docker + Docker Compose</td>
<td>ğŸ—</td>
<td></td>
</tr>
<tr>
<td>é›†ç¾¤éƒ¨ç½²</td>
<td>Jenkins + Docker Swarm</td>
<td>ğŸ—</td>
<td>ä½¿ç”¨ Docker åŸç”Ÿé›†ç¾¤éƒ¨ç½²ç®¡ç†å·¥å…·</td>
</tr>
</tbody>
</table>
<h3 id="2-å¹³å°ç®¡ç†é¡µé¢ä¸»è¦åŠŸèƒ½è§„åˆ’">2. å¹³å°ç®¡ç†é¡µé¢ä¸»è¦åŠŸèƒ½è§„åˆ’ï¼š</h3>
<table>
<thead>
<tr>
<th>æœåŠ¡</th>
<th>ä½¿ç”¨æŠ€æœ¯</th>
<th>è¿›åº¦</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç”¨æˆ·ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>ç”¨æˆ·æ˜¯ç³»ç»Ÿæ“ä½œè€…ï¼Œè¯¥åŠŸèƒ½ä¸»è¦å®Œæˆç³»ç»Ÿç”¨æˆ·é…ç½®ã€‚</td>
</tr>
<tr>
<td>è§’è‰²ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>è§’è‰²èœå•æƒé™åˆ†é…ã€è®¾ç½®è§’è‰²æŒ‰æœºæ„è¿›è¡Œæ•°æ®èŒƒå›´æƒé™åˆ’åˆ†ã€‚</td>
</tr>
<tr>
<td>èœå•ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>é…ç½®ç³»ç»Ÿèœå•ï¼Œæ“ä½œæƒé™ï¼ŒæŒ‰é’®æƒé™æ ‡è¯†ç­‰ã€‚</td>
</tr>
<tr>
<td>éƒ¨é—¨ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>é…ç½®ç³»ç»Ÿç»„ç»‡æœºæ„ï¼Œæ ‘ç»“æ„å±•ç°ï¼Œå¯éšæ„è°ƒæ•´ä¸Šä¸‹çº§ã€‚</td>
</tr>
<tr>
<td>ä»£ç ç”Ÿæˆç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>ç”¨äºç”Ÿæˆç³»ç»Ÿé¡µé¢ä»£ç ï¼ŒåŒ…æ‹¬å‰ç«¯ä»£ç ã€åç«¯ä»£ç </td>
</tr>
<tr>
<td>ç»Ÿä¸€æ–‡æ¡£ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>æ–‡æ¡£ç®¡ç†</td>
</tr>
<tr>
<td>æ“ä½œå®¡è®¡</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>ç³»ç»Ÿå…³é”®æ“ä½œæ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢</td>
</tr>
<tr>
<td>ç¼“å­˜ç®¡ç†</td>
<td>è‡ªå¼€å‘</td>
<td>ğŸ—</td>
<td>é€šè¿‡é¡µé¢å¯è§†åŒ–ç®¡ç†ç¼“å­˜</td>
</tr>
</tbody>
</table>
<h2 id="ç³»ç»Ÿæ¶æ„">ğŸ¥ ç³»ç»Ÿæ¶æ„</h2>
<h3 id="ç³»ç»Ÿæ¶æ„å›¾">ç³»ç»Ÿæ¶æ„å›¾</h3>
<blockquote>
<p>å¾…å®Œå–„</p>
</blockquote>
<h3 id="é¡¹ç›®æœåŠ¡">é¡¹ç›®æœåŠ¡</h3>
<blockquote>
<p>ä»¥ä¸‹æœåŠ¡å‡é‡‡ç”¨ Docker &amp; Docker Composeï¼Œæ”¯æŒä¸€é”®éƒ¨ç½²ã€‚ï¼ˆå¾…å®Œå–„ï¼‰</p>
</blockquote>
<h4 id="1-åŸºç¡€æœåŠ¡">1. åŸºç¡€æœåŠ¡</h4>
<table>
<thead>
<tr>
<th>æœåŠ¡</th>
<th>æœåŠ¡å</th>
<th>ç«¯å£</th>
<th>è¿›åº¦</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•°æ®åº“</td>
<td>mysql</td>
<td>3306</td>
<td>âœ…</td>
<td>å…±ç”¨ï¼Œå„åº”ç”¨å¯å»ºä¸åŒçš„ database</td>
</tr>
<tr>
<td>KVç¼“å­˜</td>
<td>redis</td>
<td>6379</td>
<td>âœ…</td>
<td>å…±ç”¨ï¼ŒåŸåˆ™ä¸Šå„åº”ç”¨å•ç‹¬å®ä¾‹</td>
</tr>
<tr>
<td>æ¶ˆæ¯ä¸­é—´ä»¶</td>
<td>rabbitmq</td>
<td>5672</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
<tr>
<td>æ³¨å†Œä¸é…ç½®ä¸­å¿ƒ</td>
<td>nacos</td>
<td>8848</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
<tr>
<td>æœç´¢å¼•æ“ä¸­é—´ä»¶</td>
<td>elasticsearch</td>
<td>9200</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
<tr>
<td>æ—¥å¿—åˆ†æå·¥å…·</td>
<td>kibana</td>
<td>5601</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
<tr>
<td>æ•°æ®å¯è§†åŒ–å·¥å…·</td>
<td>grafana</td>
<td>3000</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
<tr>
<td>å¯¹è±¡å­˜å‚¨æœåŠ¡</td>
<td>MinIO</td>
<td>9000</td>
<td>âœ…</td>
<td>å…±ç”¨</td>
</tr>
</tbody>
</table>
<h4 id="2åº”ç”¨æœåŠ¡">2.åº”ç”¨æœåŠ¡</h4>
<blockquote>
<p>ä»¥ä¸‹æœåŠ¡å‡éœ€è¦ä¾èµ–åŸºç¡€æœåŠ¡ä¸­çš„ nacosï¼ŒåŠ¡å¿…ç¡®ä¿ nacos æ­£å¸¸è¿è¡Œï¼Œé¡¹ç›®çš„é…ç½®æ–‡ä»¶å‡ä¿å­˜åœ¨ nacos é…ç½®ä¸­å¿ƒç»Ÿä¸€ç®¡ç†ï¼Œæœ¬åœ°æ— é…ç½®<br>
æ‰€æœ‰åº”ç”¨éƒ½éœ€è¦è¿›è¿‡ç½‘å…³ï¼ŒåŠ¡å¿…ä¿è¯ç½‘å…³å¯åŠ¨ï¼ˆå¼€å‘ç¯å¢ƒè°ƒè¯•å¯ä¸åšé™åˆ¶ï¼‰</p>
</blockquote>
<table>
<thead>
<tr>
<th>æœåŠ¡å</th>
<th>è¿›åº¦</th>
<th>ç®€ä»‹</th>
<th>åº”ç”¨åœ°å€</th>
<th>æ–‡æ¡£</th>
</tr>
</thead>
<tbody>
<tr>
<td>dragon-web</td>
<td>âœ…</td>
<td>å‰ç«¯ç®¡ç†é¡µé¢ï¼ˆé€æ­¥å®Œå–„ä¸­ï¼‰</td>
<td>http://localhost:18888</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>gateway</td>
<td>âœ…</td>
<td>ç»Ÿä¸€APIç½‘å…³ï¼Œè´Ÿè´£è·¯ç”±è½¬å‘</td>
<td>http://localhost:10081</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>auth-server</td>
<td>âœ…</td>
<td>è®¤è¯æœåŠ¡ï¼Œç”Ÿæˆjwt</td>
<td>http://localhost:10082</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>resource-server</td>
<td>âœ…</td>
<td>æˆæƒæœåŠ¡ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥è®¿é—®</td>
<td>http://localhost:10083</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>user-center</td>
<td>âœ…</td>
<td>ç”¨æˆ·ä¸­å¿ƒï¼Œæƒé™è§’è‰²ç®¡ç†ç­‰ï¼ˆé€æ­¥å®Œå–„ä¸­ï¼‰</td>
<td>http://localhost:10084</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>upload-center</td>
<td>ğŸ—</td>
<td>æ–‡ä»¶ä¸Šä¼ ä¸­å¿ƒ</td>
<td>http://localhost:10085</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>code-generate</td>
<td>âœ…</td>
<td>ä»£ç ç”Ÿæˆä¸­å¿ƒï¼Œå¿«é€Ÿç”Ÿæˆå‰åç«¯ä»£ç ï¼ˆé€æ­¥å®Œå–„ä¸­ï¼‰</td>
<td>http://localhost:10086</td>
<td>å¾…å®Œå–„</td>
</tr>
<tr>
<td>æœªå®Œå¾…ç»­</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<h2 id="é¡¹ç›®åŠŸèƒ½é¢„è§ˆ">é¡¹ç›®åŠŸèƒ½é¢„è§ˆ</h2>
<h3 id="ç™»å½•é¡µé¢"><strong>ç™»å½•é¡µé¢</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/login.jpg" width="576px" syt height="324px" />
<h3 id="ç”¨æˆ·ç®¡ç†"><strong>ç”¨æˆ·ç®¡ç†</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/user.jpg" width="576px" syt height="324px" />
<h3 id="è§’è‰²ç®¡ç†"><strong>è§’è‰²ç®¡ç†</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/role.jpg" width="576px" syt height="324px" />
<h3 id="èœå–®ç®¡ç†"><strong>èœå–®ç®¡ç†</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/menu.jpg" width="576px" syt height="324px" />
<h3 id="æ¥å£ç®¡ç†"><strong>æ¥å£ç®¡ç†</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/api.jpg" width="576px" syt height="324px" />
<h3 id="æ³¨å†Šä¸­å¿ƒ"><strong>æ³¨å†Šä¸­å¿ƒ</strong></h3>
<img src="https://oss.gagajiankang.com/cloud/nacos.jpg" width="576px" syt height="324px" />
<h3 id="æ–‡ä»¶ä¸Šä¼ "><strong>æ–‡ä»¶ä¸Šä¼ </strong></h3>
<img src="https://oss.gagajiankang.com/cloud/minio.jpg" width="576px" syt height="324px" />
<p><strong>æ›´å¤šé¢„è§ˆå›¾ï¼Œå°½è¯·æœŸå¾…</strong></p>
<h2 id="è”ç³»äº¤æµ">è”ç³»äº¤æµ</h2>
<h3 id="åŠ å…¥è´¡çŒ®ä»£ç ">åŠ å…¥è´¡çŒ®ä»£ç </h3>
<p><a href="">è¯·æˆ³è¿™é‡Œ</a> åŠ ç¾¤ä¸»å¾®ä¿¡ã€‚</p>
<h3 id="ç»™ä½œè€…-star-æ”¯æŒ">ç»™ä½œè€… Star æ”¯æŒ</h3>
<p>å¦‚æœä½ è§‰çš„æœ‰å¸®åŠ©åˆ°æ‚¨ï¼Œè¯·å¸®å¿™ç‚¹å‡»å³ä¸Šè§’ star æ”¯æŒæˆ‘ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘çš„åŠ¨åŠ›ã€‚</p>
<h3 id="å­¦ä¹ äº¤æµ">å­¦ä¹ äº¤æµ</h3>
<ul>
<li>é‚®ç®±ï¼šustbcxl@163.com</li>
<li></li>
</ul>
<p>åŠ ç¾¤<a href="https://qm.qq.com/cgi-bin/qm/qr?k=gQw2MJysfnRTy9qKf8hWnK-xB24c__Dj&amp;authKey=pxIxNHae0uFqcQenxT72xKQ3Isz3Xt5p9J+d2RCUPr2HaqLv+KElTKavXBPvgKsj&amp;noverify=0">è¯·æˆ³è¿™é‡Œ</a></p>
<ul>
<li><a href="https://github.com/cxl-sky/cloud-dragon">é¡¹ç›®åœ°å€æˆ³è¿™é‡Œï¼Œè®°å¾— Star æ”¯æŒä¸€ä¸‹å“¦</a></li>
<li><a href="https://github.com/cxl-sky/cloud-dragon/blob/master/docs/quick-start.md">10 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[JetCache ç¼“å­˜æ¡†æ¶]]></title>
        <id>https://www.cxlsky.com/post/jetcache-huan-cun-kuang-jia/</id>
        <link href="https://www.cxlsky.com/post/jetcache-huan-cun-kuang-jia/">
        </link>
        <updated>2021-06-10T03:24:47.000Z</updated>
        <summary type="html"><![CDATA[<p>ä¹‹å‰ä¸€ç›´åœ¨ç”¨Spring Cacheè¿›è¡Œæ¥å£æ•°æ®çš„ç¼“å­˜ï¼Œä¸»è¦æ˜¯Spring Cacheåœ¨å¯¹å…·ä½“keyç¼“å­˜å¤±æ•ˆæ—¶é—´çš„è®¾ç½®ä¸æ˜¯å¾ˆæ–¹æ³•ï¼Œè¿˜è¦è‡ªå·±å»æ‰©å±•ï¼Œæ— æ„ä¸­å‘ç°äº†é˜¿é‡Œçš„JetCacheã€‚å¤§éƒ¨åˆ†çš„éœ€æ±‚éƒ½èƒ½æ»¡è¶³ï¼Œå¹¶ä¸”æœ‰ä¸€äº›å¾ˆå®ç”¨çš„åŠŸèƒ½ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>ä¹‹å‰ä¸€ç›´åœ¨ç”¨Spring Cacheè¿›è¡Œæ¥å£æ•°æ®çš„ç¼“å­˜ï¼Œä¸»è¦æ˜¯Spring Cacheåœ¨å¯¹å…·ä½“keyç¼“å­˜å¤±æ•ˆæ—¶é—´çš„è®¾ç½®ä¸æ˜¯å¾ˆæ–¹æ³•ï¼Œè¿˜è¦è‡ªå·±å»æ‰©å±•ï¼Œæ— æ„ä¸­å‘ç°äº†é˜¿é‡Œçš„JetCacheã€‚å¤§éƒ¨åˆ†çš„éœ€æ±‚éƒ½èƒ½æ»¡è¶³ï¼Œå¹¶ä¸”æœ‰ä¸€äº›å¾ˆå®ç”¨çš„åŠŸèƒ½ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸‹ã€‚</p>
<!-- more -->
<p>JetCacheæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ç¼“å­˜ç³»ç»Ÿå°è£…ï¼Œæä¾›ç»Ÿä¸€çš„APIå’Œæ³¨è§£æ¥ç®€åŒ–ç¼“å­˜çš„ä½¿ç”¨ã€‚ JetCacheæä¾›äº†æ¯”SpringCacheæ›´åŠ å¼ºå¤§çš„æ³¨è§£ï¼Œå¯ä»¥åŸç”Ÿçš„æ”¯æŒTTLã€ä¸¤çº§ç¼“å­˜ã€åˆ†å¸ƒå¼è‡ªåŠ¨åˆ·æ–°ï¼Œè¿˜æä¾›äº†Cacheæ¥å£ç”¨äºæ‰‹å·¥ç¼“å­˜æ“ä½œã€‚ å½“å‰æœ‰å››ä¸ªå®ç°ï¼ŒRedisCacheã€TairCacheï¼ˆæ­¤éƒ¨åˆ†æœªåœ¨githubå¼€æºï¼‰ã€CaffeineCache(in memory)å’Œä¸€ä¸ªç®€æ˜“çš„LinkedHashMapCache(in memory)ï¼Œè¦æ·»åŠ æ–°çš„å®ç°ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ã€‚</p>
<p>GitHubåœ°å€ï¼š<a href="https://github.com/alibaba/jetcache">https://github.com/alibaba/jetcache</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§</h2>
<ol>
<li>é€šè¿‡ç»Ÿä¸€çš„APIè®¿é—®Cacheç³»ç»Ÿ</li>
<li>é€šè¿‡æ³¨è§£å®ç°å£°æ˜å¼çš„æ–¹æ³•ç¼“å­˜ï¼Œæ”¯æŒTTLå’Œä¸¤çº§ç¼“å­˜</li>
<li>é€šè¿‡æ³¨è§£åˆ›å»ºå¹¶é…ç½®Cacheå®ä¾‹</li>
<li>é’ˆå¯¹æ‰€æœ‰Cacheå®ä¾‹å’Œæ–¹æ³•ç¼“å­˜çš„è‡ªåŠ¨ç»Ÿè®¡</li>
<li>Keyçš„ç”Ÿæˆç­–ç•¥å’ŒValueçš„åºåˆ—åŒ–ç­–ç•¥æ˜¯å¯ä»¥é…ç½®çš„</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜è‡ªåŠ¨åˆ·æ–°ï¼Œåˆ†å¸ƒå¼é” (2.2+)</li>
<li>å¼‚æ­¥Cache API (2.2+ï¼Œä½¿ç”¨Redisçš„lettuceå®¢æˆ·ç«¯æ—¶)</li>
<li>Spring Bootæ”¯æŒ</li>
</ol>
<h2 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h2>
<h3 id="1-mavenä¾èµ–">1. mavenä¾èµ–</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.alicp.jetcache&lt;/groupId&gt;
    &lt;artifactId&gt;jetcache-starter-redis&lt;/artifactId&gt;
    &lt;version&gt;2.5.11&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="2-springbooté…ç½®">2. springbooté…ç½®</h3>
<h4 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</h4>
<pre><code class="language-text"># é‡‡ç”¨Javaåºåˆ—åŒ–å­˜å‚¨
jetcache.remote.default.valueDecoder = java
# Keyçš„è½¬æ¢å™¨
jetcache.remote.default.keyConvertor = fastjson
# æ˜¯å¦åŠ å…¥ç¼“å­˜keyå‰ç¼€
jetcache.areaInCacheName = false
jetcache.remote.default.valueEncoder = java
# ç¼“å­˜ç±»å‹ã€‚tairã€redisä¸ºå½“å‰æ”¯æŒçš„è¿œç¨‹ç¼“å­˜ï¼›linkedhashmapã€caffeineä¸ºå½“å‰æ”¯æŒçš„æœ¬åœ°ç¼“å­˜ç±»å‹
jetcache.local.default.type = linkedhashmap
# æ§åˆ¶å°è¾“å‡ºç»Ÿè®¡æ•°æ®ï¼Œç»Ÿè®¡é—´éš”ï¼Œ0è¡¨ç¤ºä¸ç»Ÿè®¡
jetcache.statIntervalMinutes = 15
jetcache.local.default.keyConvertor = fastjson
jetcache.remote.default.uri = redis://192.168.0.210:6379/
</code></pre>
<p>å…¶ä¸­ï¼šremote è¡¨ç¤ºè¿œç¨‹ç¼“å­˜ï¼Œlocalè¡¨ç¤ºæœ¬åœ°ç¼“å­˜</p>
<h4 id="å¯åŠ¨ç±»">å¯åŠ¨ç±»</h4>
<pre><code class="language-java">@SpringBootApplication
@EnableMethodCache(basePackages = &quot;com.cxytiandi.jetcache&quot;)
@EnableCreateCacheAnnotation
public class App {
    public static void main(String[] args) {
        SpringApplication.run(App.class);
    }
}
</code></pre>
<p>å…¶ä¸­ï¼š<br>
@EnableMethodCache ç”¨äºæ¿€æ´»@Cachedæ³¨è§£çš„ä½¿ç”¨ï¼Œ<br>
@EnableCreateCacheAnnotation ç”¨äºæ¿€æ´»@CreateCacheæ³¨è§£çš„ä½¿ç”¨</p>
<h4 id="å®šä¹‰ä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥ä½œä¸ºæ•°æ®çš„ç¼“å­˜å¿…é¡»å®ç°serializableæ¥å£">å®šä¹‰ä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥ä½œä¸ºæ•°æ®çš„ç¼“å­˜ï¼Œå¿…é¡»å®ç°Serializableæ¥å£ã€‚</h4>
<pre><code class="language-java">@Data
public class User implements Serializable {

	private Long id;
	
	private String name;

}
</code></pre>
<h4 id="createcacheä½¿ç”¨">@CreateCacheä½¿ç”¨</h4>
<pre><code class="language-java">@CreateCache(expire = 100)
private Cache&lt;Long, User&gt; userCache;

User user = new User();
user.setId(1L);
user.setName(&quot;yinjihuan&quot;);
// æ–°å¢ç¼“å­˜
userCache.put(1L, user);

// åˆ é™¤ç¼“å­˜
userCache.remove(1L);
</code></pre>
<p>ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œå°±åƒä½¿ç”¨mapä¸€æ ·ï¼Œ@CreateCacheä¸­æœ‰å¾ˆå¤šé…ç½®éœ€è¦æˆ‘ä»¬è‡ªå·±å»æŒ‡å®šï¼Œä¸æŒ‡å®šåˆ™ä½¿ç”¨é»˜è®¤çš„ï¼Œå…³äºé…ç½®è¯·æŸ¥çœ‹æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/jetcache/wiki/CreateCache_CN">https://github.com/alibaba/jetcache/wiki/CreateCache_CN</a></p>
<h4 id="cachedä½¿ç”¨">@Cachedä½¿ç”¨</h4>
<pre><code class="language-java">@Cached(name=&quot;getUser.&quot;, key=&quot;#id&quot;, expire = 8, cacheType=CacheType.BOTH)
@Override
public User getUser(Long id) {
	User user = new User();
	user.setId(1L);
	user.setName(&quot;yinjihuan&quot;);
	return user;
}
</code></pre>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>nameï¼šç¼“å­˜åç§°</li>
<li>keyï¼šç¼“å­˜key,è¿½åŠ åˆ°nameåé¢æ„æˆå”¯ä¸€çš„ç¼“å­˜key, ä½¿ç”¨SpELæŒ‡å®škeyï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šä¼šæ ¹æ®æ‰€æœ‰å‚æ•°è‡ªåŠ¨ç”Ÿæˆã€‚</li>
<li>expireï¼šç¼“å­˜å¤±æ•ˆæ—¶é—´</li>
<li>cacheTypeï¼šç¼“å­˜çš„ç±»å‹ï¼ŒåŒ…æ‹¬CacheType.REMOTEã€CacheType.LOCALã€CacheType.BOTHã€‚å¦‚æœå®šä¹‰ä¸ºBOTHï¼Œä¼šä½¿ç”¨LOCALå’ŒREMOTEç»„åˆæˆä¸¤çº§ç¼“å­˜<br>
æ›´å¤šé…ç½®çš„ä»‹ç»è¯·æŸ¥çœ‹æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/jetcache/wiki/MethodCache_CN">https://github.com/alibaba/jetcache/wiki/MethodCache_CN</a></li>
</ul>
<p>ä»Šå¤©çš„ä»‹ç»å°±åˆ°è¿™é‡Œï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå…³äºæ›´å¤šçš„åŠŸèƒ½å¤§å®¶è‡ªè¡Œå»å°è¯•å§ï¼Œæ¯”å¦‚ç¼“å­˜å®šæ—¶åˆ·æ–°ï¼Œç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡ï¼Œè‡ªå®šä¹‰åºåˆ—åŒ–æ–¹å¼ç­‰ç­‰ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[JS å¯¼å‡º Excel]]></title>
        <id>https://www.cxlsky.com/post/js-dao-chu-excel/</id>
        <link href="https://www.cxlsky.com/post/js-dao-chu-excel/">
        </link>
        <updated>2021-06-07T01:40:19.000Z</updated>
        <summary type="html"><![CDATA[<blockquote>
<p>åœ¨æˆ‘ä»¬å¼€å‘é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥éƒ½ä¼šé‡åˆ° excel å¯¼å‡ºåŠŸèƒ½ã€‚é‚£ä¹ˆç°åœ¨æˆ‘å¯¹ excel å¯¼å‡ºæ–¹æ³•åšå¦‚ä¸‹çš„è®°å½•ï¼Œæ–¹ä¾¿ä»¥åæŸ¥çœ‹ï¼Œå¹¶ä¸”åˆ†äº«ç»™å¤§å®¶ã€‚</p>
</blockquote>
]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>åœ¨æˆ‘ä»¬å¼€å‘é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥éƒ½ä¼šé‡åˆ° excel å¯¼å‡ºåŠŸèƒ½ã€‚é‚£ä¹ˆç°åœ¨æˆ‘å¯¹ excel å¯¼å‡ºæ–¹æ³•åšå¦‚ä¸‹çš„è®°å½•ï¼Œæ–¹ä¾¿ä»¥åæŸ¥çœ‹ï¼Œå¹¶ä¸”åˆ†äº«ç»™å¤§å®¶ã€‚</p>
</blockquote>
<!-- more -->
<h2 id="ä¸€-çº¯-js-å¯¼å‡º-excel">ä¸€ã€çº¯ JS å¯¼å‡º EXCEL</h2>
<p>æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ–å¤šæˆ–å°‘ä¼šé‡åˆ°ä¸éœ€è¦è°ƒç”¨æ¥å£æ¥å¯¼å‡º EXCEL çš„æƒ…å†µï¼Œé‚£ä¹ˆå¯ä»¥å‚ç…§å¦‚ä¸‹ä»£ç ï¼Œå®ç°å‰ç«¯çº¯ JS å¯¼å‡º EXCELã€‚</p>
<pre><code class="language-javascript">export function tableToExcel(jsonData, fileName) {
  let str = '';
  //å¾ªç¯éå†ï¼Œæ¯è¡ŒåŠ å…¥træ ‡ç­¾ï¼Œæ¯ä¸ªå•å…ƒæ ¼åŠ tdæ ‡ç­¾
  for (let i = 0; i &lt; jsonData.length; i++) {
    // æ•°æ®åˆ—æ ‡é¢˜
    if (i === 0) {
      str += '&lt;tr&gt;';
      for (let item in jsonData[i]) {
        //å¢åŠ \tä¸ºäº†ä¸è®©è¡¨æ ¼æ˜¾ç¤ºç§‘å­¦è®¡æ•°æ³•æˆ–è€…å…¶ä»–æ ¼å¼
        str += `&lt;td&gt;${item + '\t'}&lt;/td&gt;`;
      }
      str += '&lt;/tr&gt;';
    }
    // æ•°æ®å†…å®¹
    str += '&lt;tr&gt;';
    for (let item in jsonData[i]) {
      //å¢åŠ \tä¸ºäº†ä¸è®©è¡¨æ ¼æ˜¾ç¤ºç§‘å­¦è®¡æ•°æ³•æˆ–è€…å…¶ä»–æ ¼å¼
      str += `&lt;td&gt;${jsonData[i][item] + '\t'}&lt;/td&gt;`;
    }
    str += '&lt;/tr&gt;';
  }
  // Worksheetå
  let worksheet = 'Sheet1';
  let uri = 'data:application/vnd.ms-excel;base64,';

  // ä¸‹è½½çš„è¡¨æ ¼æ¨¡æ¿æ•°æ®
  let template = `&lt;html xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;
      xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot;
      xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;
      &lt;head&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;&lt;x:ExcelWorkbook&gt;&lt;x:ExcelWorksheets&gt;&lt;x:ExcelWorksheet&gt;
        &lt;x:Name&gt;${worksheet}&lt;/x:Name&gt;
        &lt;x:WorksheetOptions&gt;&lt;x:DisplayGridlines/&gt;&lt;/x:WorksheetOptions&gt;&lt;/x:ExcelWorksheet&gt;
        &lt;/x:ExcelWorksheets&gt;&lt;/x:ExcelWorkbook&gt;&lt;/xml&gt;&lt;![endif]--&gt;
        &lt;/head&gt;&lt;body&gt;&lt;table&gt;${str}&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;`;
        
        
  // ç›´æ¥ä¸‹è½½ï¼ˆæ­¤æ–¹æ³•ä¸èƒ½è‡ªå®šä¹‰æ–‡ä»¶åï¼‰
  // window.location.href = uri + base64(template)

  // é€šè¿‡åˆ›å»ºaæ ‡ç­¾ä¸‹è½½ï¼ˆæ­¤æ–¹æ³•å¯ä»¥è‡ªå®šä¹‰æ–‡ä»¶åï¼‰
  let a = document.createElement('a');
  a.href = uri + base64(template);
  a.download = `${fileName}_${new Date().toLocaleString()}.xlsx`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);


}

// è¾“å‡ºbase64ç¼–ç 
function base64(s) {
  return window.btoa(unescape(encodeURIComponent(s)))
}

</code></pre>
<h2 id="äºŒ-é€šè¿‡æ¥å£å¯¼å‡º-excel">äºŒã€é€šè¿‡æ¥å£å¯¼å‡º EXCEL</h2>
<p>å½“æˆ‘ä»¬çš„å¯¼å‡ºæ•°æ®éœ€è¦ä»åç«¯è·å–æ—¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œå¯¼å‡ºã€‚<br>
æœ¬ä¾‹ä½¿ç”¨äº† axios è¯·æ±‚æœåŠ¡ç«¯æ•°æ®ï¼Œå¦‚è¿‡æ˜¯å…¶ä»–æ–¹å¼ç±»ä¼¼ï¼Œè¯·çœ‹å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-javascript">exportExcel(url, data, fileName) {
    return axios({
&lt;!-- more --&gt;

      url: url,
      baseURL: baseApi,
      method: 'post',
      data: JSON.stringify(data),
      responseType: 'blob',
      headers: {
        'X-Requested-With': 'XMLHttpRequest',
        'content-type': 'application/json; charset=utf-8'
      }
    }).then((res) =&gt; {
      if (res.status === 200) {
        let tempBlob = new Blob([res.data, {type :'application/vnd.ms-excel:charset=utf-8'}]);
        let targetUrl = window.URL.createObjectURL(tempBlob);
        let a = document.createElement('a');
        a.href = targetUrl;
        a.download = `${fileName}_${new Date().toLocaleString()}.xlsx`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      } else {
        console.log(&quot;è¯·æ±‚èµ„æºå¤±è´¥&quot;)
      }
    }).catch(e=&gt;console.log(e))
  },
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ³¨å†Œä¸­å¿ƒConsul]]></title>
        <id>https://www.cxlsky.com/post/æ³¨å†Œä¸­å¿ƒConsul - å‰¯æœ¬/</id>
        <link href="https://www.cxlsky.com/post/æ³¨å†Œä¸­å¿ƒConsul - å‰¯æœ¬/">
        </link>
        <updated>2020-02-11T05:17:08.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¸€-ä¸ºä»€ä¹ˆé€‰æ‹©consul">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹©consul</h2>
<p>æˆ‘ä»¬çŸ¥é“ Eureka 2.X é‡åˆ°å›°éš¾åœæ­¢å¼€å‘äº†ï¼Œä½†å…¶å®å¯¹å›½å†…çš„ç”¨æˆ·å½±å“ç”šå°ï¼Œä¸€æ–¹é¢å›½å†…å¤§éƒ½ä½¿ç”¨çš„æ˜¯ Eureka 1.X ç³»åˆ—ï¼Œå¦ä¸€æ–¹é¢ Spring Cloud æ”¯æŒå¾ˆå¤šæœåŠ¡å‘ç°çš„è½¯ä»¶ï¼ŒEureka åªæ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä¸‹é¢æ˜¯ Spring Cloud æ”¯æŒçš„æœåŠ¡å‘ç°è½¯ä»¶ä»¥åŠç‰¹æ€§å¯¹æ¯”ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://imgs.cxlsky.com/image1560846242657.jpg" alt="registry.jpg" loading="lazy"></figure>
<p>åœ¨ä»¥ä¸ŠæœåŠ¡å‘ç°çš„è½¯ä»¶ä¸­ï¼ŒEuerka å’Œ Consul ä½¿ç”¨æœ€ä¸ºå¹¿æ³›ã€‚ä½†ç”±äºeurekaå·²ç»åœæ­¢æ›´æ–°ï¼Œæ‰€ä»¥è¿™é‡Œé€‰ç”¨consulã€‚</p>
<h2 id="äºŒ-consulä»‹ç»">äºŒã€Consulä»‹ç»</h2>
<p>Consul æ˜¯ HashiCorp å…¬å¸æ¨å‡ºçš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚ä¸å…¶å®ƒåˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ–¹æ¡ˆï¼ŒConsul çš„æ–¹æ¡ˆæ›´â€œä¸€ç«™å¼â€ï¼Œå†…ç½®äº†æœåŠ¡æ³¨å†Œä¸å‘ç°æ¡† æ¶ã€åˆ†å¸ƒä¸€è‡´æ€§åè®®å®ç°ã€å¥åº·æ£€æŸ¥ã€Key/Value å­˜å‚¨ã€å¤šæ•°æ®ä¸­å¿ƒæ–¹æ¡ˆï¼Œä¸å†éœ€è¦ä¾èµ–å…¶å®ƒå·¥å…·ï¼ˆæ¯”å¦‚ ZooKeeper ç­‰ï¼‰ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿè¾ƒ ä¸ºç®€å•ã€‚Consul ä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œå› æ­¤å…·æœ‰å¤©ç„¶å¯ç§»æ¤æ€§(æ”¯æŒLinuxã€windowså’ŒMac OS X)ï¼›å®‰è£…åŒ…ä»…åŒ…å«ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–¹ä¾¿éƒ¨ç½²ï¼Œä¸ Docker ç­‰è½»é‡çº§å®¹å™¨å¯æ— ç¼é…åˆã€‚</p>
<h3 id="21-consulä¼˜åŠ¿">2.1 consulä¼˜åŠ¿</h3>
<p>1ã€ä½¿ç”¨ Raft ç®—æ³•æ¥ä¿è¯ä¸€è‡´æ€§, æ¯”å¤æ‚çš„ Paxos ç®—æ³•æ›´ç›´æ¥. ç›¸æ¯”è¾ƒè€Œè¨€, zookeeper é‡‡ç”¨çš„æ˜¯ Paxos, è€Œ etcd ä½¿ç”¨çš„åˆ™æ˜¯ Raftã€‚<br>
2ã€æ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼Œå†…å¤–ç½‘çš„æœåŠ¡é‡‡ç”¨ä¸åŒçš„ç«¯å£è¿›è¡Œç›‘å¬ã€‚ å¤šæ•°æ®ä¸­å¿ƒé›†ç¾¤å¯ä»¥é¿å…å•æ•°æ®ä¸­å¿ƒçš„å•ç‚¹æ•…éšœ,è€Œå…¶éƒ¨ç½²åˆ™éœ€è¦è€ƒè™‘ç½‘ç»œå»¶è¿Ÿ, åˆ†ç‰‡ç­‰æƒ…å†µç­‰ã€‚ zookeeper å’Œ etcd å‡ä¸æä¾›å¤šæ•°æ®ä¸­å¿ƒåŠŸèƒ½çš„æ”¯æŒã€‚<br>
3ã€æ”¯æŒå¥åº·æ£€æŸ¥ã€‚ etcd ä¸æä¾›æ­¤åŠŸèƒ½ã€‚<br>
4ã€æ”¯æŒ http å’Œ dns åè®®æ¥å£ã€‚ zookeeper çš„é›†æˆè¾ƒä¸ºå¤æ‚, etcd åªæ”¯æŒ http åè®®ã€‚<br>
5ã€å®˜æ–¹æä¾› web ç®¡ç†ç•Œé¢, etcd æ— æ­¤åŠŸèƒ½ã€‚<br>
6ã€ç»¼åˆæ¯”è¾ƒ, Consul ä½œä¸ºæœåŠ¡æ³¨å†Œå’Œé…ç½®ç®¡ç†çš„æ–°æ˜Ÿ, æ¯”è¾ƒå€¼å¾—å…³æ³¨å’Œç ”ç©¶ã€‚</p>
<h3 id="22-consulè§’è‰²">2.2 Consulè§’è‰²</h3>
<p>1ã€client: å®¢æˆ·ç«¯, æ— çŠ¶æ€, å°† HTTP å’Œ DNS æ¥å£è¯·æ±‚è½¬å‘ç»™å±€åŸŸç½‘å†…çš„æœåŠ¡ç«¯é›†ç¾¤ã€‚<br>
2ã€server: æœåŠ¡ç«¯, ä¿å­˜é…ç½®ä¿¡æ¯, é«˜å¯ç”¨é›†ç¾¤, åœ¨å±€åŸŸç½‘å†…ä¸æœ¬åœ°å®¢æˆ·ç«¯é€šè®¯, é€šè¿‡å¹¿åŸŸç½‘ä¸å…¶å®ƒæ•°æ®ä¸­å¿ƒé€šè®¯ã€‚ æ¯ä¸ªæ•°æ®ä¸­å¿ƒçš„ server æ•°é‡æ¨èä¸º 3 ä¸ªæˆ–æ˜¯ 5 ä¸ªã€‚</p>
<p>Consul å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯è¿˜æ”¯æŒå¤¸ä¸­å¿ƒçš„ä½¿ç”¨ï¼Œæ›´åŠ æé«˜äº†å®ƒçš„é«˜å¯ç”¨æ€§ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://imgs.cxlsky.com/image1560846818889.jpg" alt="consul.jpg" loading="lazy"></figure>
<h3 id="23-consulå·¥ä½œåŸç†">2.3 Consulå·¥ä½œåŸç†</h3>
<figure data-type="image" tabindex="3"><img src="https://imgs.cxlsky.com/image1560846871580.jpg" alt="consul1.jpg" loading="lazy"></figure>
<p>1ã€å½“ Producer å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå‘ Consul å‘é€ä¸€ä¸ª post è¯·æ±‚ï¼Œå‘Šè¯‰ Consul è‡ªå·±çš„ IP å’Œ Port<br>
2ã€Consul æ¥æ”¶åˆ° Producer çš„æ³¨å†Œåï¼Œæ¯éš”10sï¼ˆé»˜è®¤ï¼‰ä¼šå‘ Producer å‘é€ä¸€ä¸ªå¥åº·æ£€æŸ¥çš„è¯·æ±‚ï¼Œæ£€éªŒProduceræ˜¯å¦å¥åº·<br>
3ã€å½“ Consumer å‘é€ GET æ–¹å¼è¯·æ±‚ /api/address åˆ° Producer æ—¶ï¼Œä¼šå…ˆä» Consul ä¸­æ‹¿åˆ°ä¸€ä¸ªå­˜å‚¨æœåŠ¡ IP å’Œ Port çš„ä¸´æ—¶è¡¨ï¼Œä»è¡¨ä¸­æ‹¿åˆ° Producer çš„ IP å’Œ Port åå†å‘é€ GET æ–¹å¼è¯·æ±‚ /api/address<br>
4ã€è¯¥ä¸´æ—¶è¡¨æ¯éš”10sä¼šæ›´æ–°ï¼ŒåªåŒ…å«æœ‰é€šè¿‡äº†å¥åº·æ£€æŸ¥çš„ Producer</p>
<p>Spring Cloud Consul é¡¹ç›®æ˜¯é’ˆå¯¹ Consul çš„æœåŠ¡æ²»ç†å®ç°ã€‚Consul æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é«˜å¯ç”¨çš„ç³»ç»Ÿï¼Œå®ƒåŒ…å«å¤šä¸ªç»„ä»¶ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä¸ºæˆ‘ä»¬çš„åŸºç¡€è®¾æ–½æä¾›æœåŠ¡å‘ç°å’ŒæœåŠ¡é…ç½®çš„å·¥å…·ã€‚</p>
<h2 id="ä¸‰-springcloudé¡¹ç›®æ•´åˆconsul">ä¸‰ã€SpringCloudé¡¹ç›®æ•´åˆConsul</h2>
<h3 id="31-å‡†å¤‡å·¥ä½œ">3.1 å‡†å¤‡å·¥ä½œ</h3>
<p>åœ¨ä¹‹å‰çš„çˆ¶å·¥ç¨‹é¡¹ç›®ä¸­ï¼Œæ–°å»ºä¸€ä¸ªå­æ¨¡å—service-aï¼Œå¼•å…¥ä»¥ä¸‹ä¸»è¦ä¾èµ–ï¼š(å…¶ä»–ä¾èµ–å¯è‡ªè¡Œæ·»åŠ )</p>
<pre><code class="language-java">&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
		&lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt;
	&lt;/dependency&gt;
</code></pre>
<p>å…¶ä¸­spring-boot-starter-actuatorä¾èµ–ç”¨æˆ·å¥åº·æ£€æŸ¥ï¼Œå¦‚æœä¸åŠ è¿™ä¸ªä¾èµ–ï¼Œå¯ä»¥è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ã€‚<br>
å…¶ä¸­spring-cloud-starter-consul-discoveryæ˜¯consulçš„ä¾èµ–ã€‚</p>
<h3 id="32-ä¿®æ”¹é…ç½®æ–‡ä»¶">3.2 ä¿®æ”¹é…ç½®æ–‡ä»¶</h3>
<pre><code class="language-yaml">#è¿æ¥æ³¨å†Œä¸­å¿ƒ
spring:
  cloud:
    consul:
      #æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œä½¿ç”¨${}çš„å½¢å¼ï¼Œå¦‚æœå†’å·å‰é¢çš„å€¼ä¸ºç©ºï¼Œåˆ™å–åé¢çš„å€¼ã€‚
      host: ${DS_SERVER:192.168.132.131} 
      port: 8500
      discovery:
        instance-id: ${spring.application.name}-${random.uuid}

#æ­¤é…ç½®ç”¨äºå¥åº·æ£€æŸ¥
management:
  endpoints:
    web:
      exposure:
        include: &quot;*&quot;
  endpoint:
    health:
      show-details: always
</code></pre>
<h3 id="33-ä¿®æ”¹springbootå…¥å£ç±»å¢åŠ æ³¨è§£enablediscoveryclient">3.3 ä¿®æ”¹springbootå…¥å£ç±»ï¼Œå¢åŠ æ³¨è§£<code>@EnableDiscoveryClient</code></h3>
<pre><code class="language-java">@EnableDiscoveryClient
@SpringBootApplication(scanBasePackages = &quot;com.cxlsky&quot;)
@EnableFeignClients(basePackages={&quot;com.cxlsky&quot;})
public class EurekaClientAApplication {

    public static void main(String[] args) {
        SpringApplication.run(EurekaClientAApplication.class, args);
    }

}
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬springé¡¹ç›®å°±æ”¹é€ å®Œæˆäº†ã€‚</p>
<h2 id="å››-consulæœåŠ¡ç«¯çš„å®‰è£…">å››ã€ConsulæœåŠ¡ç«¯çš„å®‰è£…</h2>
<h3 id="41-è¿™é‡Œä½¿ç”¨dockerå®‰è£…å•èŠ‚ç‚¹consul">4.1 è¿™é‡Œä½¿ç”¨dockerå®‰è£…å•èŠ‚ç‚¹consulï¼š</h3>
<pre><code class="language-bash">## 1ã€æœç´¢é•œåƒ
docker search consul
## 2ã€æ‹‰å–é•œåƒ
docker pull consul
## 3ã€è¿è¡Œé•œåƒ
docker run -d -p 18500:8500 --name consul-server consul agent -server -bootstrap -client 0.0.0.0 -ui
## 4ã€æŸ¥çœ‹è¿è¡Œæ—¥å¿—
docker logs -f  consul-server
</code></pre>
<h3 id="42-æŸ¥çœ‹webé¡µé¢">4.2 æŸ¥çœ‹webé¡µé¢</h3>
<figure data-type="image" tabindex="4"><img src="https://imgs.cxlsky.com/image1560850783917.jpg" alt="consulweb.jpg" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ç°åœ¨åªæœ‰consulè‡ªå·±ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸Šå»äº†ï¼Œä¸‹é¢æˆ‘ä»¬å¯åŠ¨æˆ‘ä»¬çš„é¡¹ç›®ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://imgs.cxlsky.com/image1560851191684.jpg" alt="consulclient.jpg" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢å¤šå‡ºäº†æˆ‘ä»¬çš„æœåŠ¡ï¼Œè¿™æ ·å°±å®Œæˆäº†æœåŠ¡å‘ç°ã€‚</p>
<blockquote>
<p>ç”±äºæ³¨å†Œä¸­å¿ƒçš„é‡è¦æ€§ï¼Œæˆ‘ä»¬éœ€è¦åšé«˜å¯ç”¨ï¼Œæ‰€ä»¥éœ€è¦é›†ç¾¤éƒ¨ç½²ã€‚åç»­çš„ç« èŠ‚ä¸­æˆ‘ä¼šè®²è§£ä»¥ä¸‹docker swarmï¼Œå¹¶ä¸”ä½¿ç”¨docker swarmå¿«é€Ÿå®Œæˆconsulçš„é›†ç¾¤éƒ¨ç½²ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ³¨å†Œä¸­å¿ƒConsul]]></title>
        <id>https://www.cxlsky.com/post/æ³¨å†Œä¸­å¿ƒConsul/</id>
        <link href="https://www.cxlsky.com/post/æ³¨å†Œä¸­å¿ƒConsul/">
        </link>
        <updated>2020-02-11T05:17:08.000Z</updated>
        <summary type="html"><![CDATA[<p>åœ¨å¾®æœåŠ¡çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ³¨å†Œä¸­å¿ƒæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è§’è‰²ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°å…¶ä»–çš„æœåŠ¡ã€‚æ³¨å†Œä¸­å¿ƒä¹Ÿæœ‰å¾ˆå¤šç§ç±»ï¼Œä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ä¸‹æˆ‘ä½¿ç”¨è¿‡çš„ Consulã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>åœ¨å¾®æœåŠ¡çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ³¨å†Œä¸­å¿ƒæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è§’è‰²ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°å…¶ä»–çš„æœåŠ¡ã€‚æ³¨å†Œä¸­å¿ƒä¹Ÿæœ‰å¾ˆå¤šç§ç±»ï¼Œä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ä¸‹æˆ‘ä½¿ç”¨è¿‡çš„ Consulã€‚</p>
<!-- more -->
<h2 id="ä¸€-ä¸ºä»€ä¹ˆé€‰æ‹©consul">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹©consul</h2>
<p>æˆ‘ä»¬çŸ¥é“ Eureka 2.X é‡åˆ°å›°éš¾åœæ­¢å¼€å‘äº†ï¼Œä½†å…¶å®å¯¹å›½å†…çš„ç”¨æˆ·å½±å“ç”šå°ï¼Œä¸€æ–¹é¢å›½å†…å¤§éƒ½ä½¿ç”¨çš„æ˜¯ Eureka 1.X ç³»åˆ—ï¼Œå¦ä¸€æ–¹é¢ Spring Cloud æ”¯æŒå¾ˆå¤šæœåŠ¡å‘ç°çš„è½¯ä»¶ï¼ŒEureka åªæ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä¸‹é¢æ˜¯ Spring Cloud æ”¯æŒçš„æœåŠ¡å‘ç°è½¯ä»¶ä»¥åŠç‰¹æ€§å¯¹æ¯”ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://imgs.cxlsky.com/image1560846242657.jpg" alt="registry.jpg" loading="lazy"></figure>
<p>åœ¨ä»¥ä¸ŠæœåŠ¡å‘ç°çš„è½¯ä»¶ä¸­ï¼ŒEuerka å’Œ Consul ä½¿ç”¨æœ€ä¸ºå¹¿æ³›ã€‚ä½†ç”±äºeurekaå·²ç»åœæ­¢æ›´æ–°ï¼Œæ‰€ä»¥è¿™é‡Œé€‰ç”¨consulã€‚</p>
<h2 id="äºŒ-consulä»‹ç»">äºŒã€Consulä»‹ç»</h2>
<p>Consul æ˜¯ HashiCorp å…¬å¸æ¨å‡ºçš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚ä¸å…¶å®ƒåˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ–¹æ¡ˆï¼ŒConsul çš„æ–¹æ¡ˆæ›´â€œä¸€ç«™å¼â€ï¼Œå†…ç½®äº†æœåŠ¡æ³¨å†Œä¸å‘ç°æ¡† æ¶ã€åˆ†å¸ƒä¸€è‡´æ€§åè®®å®ç°ã€å¥åº·æ£€æŸ¥ã€Key/Value å­˜å‚¨ã€å¤šæ•°æ®ä¸­å¿ƒæ–¹æ¡ˆï¼Œä¸å†éœ€è¦ä¾èµ–å…¶å®ƒå·¥å…·ï¼ˆæ¯”å¦‚ ZooKeeper ç­‰ï¼‰ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿè¾ƒ ä¸ºç®€å•ã€‚Consul ä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œå› æ­¤å…·æœ‰å¤©ç„¶å¯ç§»æ¤æ€§(æ”¯æŒLinuxã€windowså’ŒMac OS X)ï¼›å®‰è£…åŒ…ä»…åŒ…å«ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–¹ä¾¿éƒ¨ç½²ï¼Œä¸ Docker ç­‰è½»é‡çº§å®¹å™¨å¯æ— ç¼é…åˆã€‚</p>
<h3 id="21-consulä¼˜åŠ¿">2.1 consulä¼˜åŠ¿</h3>
<p>1ã€ä½¿ç”¨ Raft ç®—æ³•æ¥ä¿è¯ä¸€è‡´æ€§, æ¯”å¤æ‚çš„ Paxos ç®—æ³•æ›´ç›´æ¥. ç›¸æ¯”è¾ƒè€Œè¨€, zookeeper é‡‡ç”¨çš„æ˜¯ Paxos, è€Œ etcd ä½¿ç”¨çš„åˆ™æ˜¯ Raftã€‚<br>
2ã€æ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼Œå†…å¤–ç½‘çš„æœåŠ¡é‡‡ç”¨ä¸åŒçš„ç«¯å£è¿›è¡Œç›‘å¬ã€‚ å¤šæ•°æ®ä¸­å¿ƒé›†ç¾¤å¯ä»¥é¿å…å•æ•°æ®ä¸­å¿ƒçš„å•ç‚¹æ•…éšœ,è€Œå…¶éƒ¨ç½²åˆ™éœ€è¦è€ƒè™‘ç½‘ç»œå»¶è¿Ÿ, åˆ†ç‰‡ç­‰æƒ…å†µç­‰ã€‚ zookeeper å’Œ etcd å‡ä¸æä¾›å¤šæ•°æ®ä¸­å¿ƒåŠŸèƒ½çš„æ”¯æŒã€‚<br>
3ã€æ”¯æŒå¥åº·æ£€æŸ¥ã€‚ etcd ä¸æä¾›æ­¤åŠŸèƒ½ã€‚<br>
4ã€æ”¯æŒ http å’Œ dns åè®®æ¥å£ã€‚ zookeeper çš„é›†æˆè¾ƒä¸ºå¤æ‚, etcd åªæ”¯æŒ http åè®®ã€‚<br>
5ã€å®˜æ–¹æä¾› web ç®¡ç†ç•Œé¢, etcd æ— æ­¤åŠŸèƒ½ã€‚<br>
6ã€ç»¼åˆæ¯”è¾ƒ, Consul ä½œä¸ºæœåŠ¡æ³¨å†Œå’Œé…ç½®ç®¡ç†çš„æ–°æ˜Ÿ, æ¯”è¾ƒå€¼å¾—å…³æ³¨å’Œç ”ç©¶ã€‚</p>
<h3 id="22-consulè§’è‰²">2.2 Consulè§’è‰²</h3>
<p>1ã€client: å®¢æˆ·ç«¯, æ— çŠ¶æ€, å°† HTTP å’Œ DNS æ¥å£è¯·æ±‚è½¬å‘ç»™å±€åŸŸç½‘å†…çš„æœåŠ¡ç«¯é›†ç¾¤ã€‚<br>
2ã€server: æœåŠ¡ç«¯, ä¿å­˜é…ç½®ä¿¡æ¯, é«˜å¯ç”¨é›†ç¾¤, åœ¨å±€åŸŸç½‘å†…ä¸æœ¬åœ°å®¢æˆ·ç«¯é€šè®¯, é€šè¿‡å¹¿åŸŸç½‘ä¸å…¶å®ƒæ•°æ®ä¸­å¿ƒé€šè®¯ã€‚ æ¯ä¸ªæ•°æ®ä¸­å¿ƒçš„ server æ•°é‡æ¨èä¸º 3 ä¸ªæˆ–æ˜¯ 5 ä¸ªã€‚</p>
<p>Consul å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯è¿˜æ”¯æŒå¤¸ä¸­å¿ƒçš„ä½¿ç”¨ï¼Œæ›´åŠ æé«˜äº†å®ƒçš„é«˜å¯ç”¨æ€§ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://imgs.cxlsky.com/image1560846818889.jpg" alt="consul.jpg" loading="lazy"></figure>
<h3 id="23-consulå·¥ä½œåŸç†">2.3 Consulå·¥ä½œåŸç†</h3>
<figure data-type="image" tabindex="3"><img src="https://imgs.cxlsky.com/image1560846871580.jpg" alt="consul1.jpg" loading="lazy"></figure>
<p>1ã€å½“ Producer å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå‘ Consul å‘é€ä¸€ä¸ª post è¯·æ±‚ï¼Œå‘Šè¯‰ Consul è‡ªå·±çš„ IP å’Œ Port<br>
2ã€Consul æ¥æ”¶åˆ° Producer çš„æ³¨å†Œåï¼Œæ¯éš”10sï¼ˆé»˜è®¤ï¼‰ä¼šå‘ Producer å‘é€ä¸€ä¸ªå¥åº·æ£€æŸ¥çš„è¯·æ±‚ï¼Œæ£€éªŒProduceræ˜¯å¦å¥åº·<br>
3ã€å½“ Consumer å‘é€ GET æ–¹å¼è¯·æ±‚ /api/address åˆ° Producer æ—¶ï¼Œä¼šå…ˆä» Consul ä¸­æ‹¿åˆ°ä¸€ä¸ªå­˜å‚¨æœåŠ¡ IP å’Œ Port çš„ä¸´æ—¶è¡¨ï¼Œä»è¡¨ä¸­æ‹¿åˆ° Producer çš„ IP å’Œ Port åå†å‘é€ GET æ–¹å¼è¯·æ±‚ /api/address<br>
4ã€è¯¥ä¸´æ—¶è¡¨æ¯éš”10sä¼šæ›´æ–°ï¼ŒåªåŒ…å«æœ‰é€šè¿‡äº†å¥åº·æ£€æŸ¥çš„ Producer</p>
<p>Spring Cloud Consul é¡¹ç›®æ˜¯é’ˆå¯¹ Consul çš„æœåŠ¡æ²»ç†å®ç°ã€‚Consul æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é«˜å¯ç”¨çš„ç³»ç»Ÿï¼Œå®ƒåŒ…å«å¤šä¸ªç»„ä»¶ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä¸ºæˆ‘ä»¬çš„åŸºç¡€è®¾æ–½æä¾›æœåŠ¡å‘ç°å’ŒæœåŠ¡é…ç½®çš„å·¥å…·ã€‚</p>
<h2 id="ä¸‰-springcloudé¡¹ç›®æ•´åˆconsul">ä¸‰ã€SpringCloudé¡¹ç›®æ•´åˆConsul</h2>
<h3 id="31-å‡†å¤‡å·¥ä½œ">3.1 å‡†å¤‡å·¥ä½œ</h3>
<p>åœ¨ä¹‹å‰çš„çˆ¶å·¥ç¨‹é¡¹ç›®ä¸­ï¼Œæ–°å»ºä¸€ä¸ªå­æ¨¡å—service-aï¼Œå¼•å…¥ä»¥ä¸‹ä¸»è¦ä¾èµ–ï¼š(å…¶ä»–ä¾èµ–å¯è‡ªè¡Œæ·»åŠ )</p>
<pre><code class="language-java">&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
		&lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt;
	&lt;/dependency&gt;
</code></pre>
<p>å…¶ä¸­spring-boot-starter-actuatorä¾èµ–ç”¨æˆ·å¥åº·æ£€æŸ¥ï¼Œå¦‚æœä¸åŠ è¿™ä¸ªä¾èµ–ï¼Œå¯ä»¥è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ã€‚<br>
å…¶ä¸­spring-cloud-starter-consul-discoveryæ˜¯consulçš„ä¾èµ–ã€‚</p>
<h3 id="32-ä¿®æ”¹é…ç½®æ–‡ä»¶">3.2 ä¿®æ”¹é…ç½®æ–‡ä»¶</h3>
<pre><code class="language-yaml">#è¿æ¥æ³¨å†Œä¸­å¿ƒ
spring:
  cloud:
    consul:
      #æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œä½¿ç”¨${}çš„å½¢å¼ï¼Œå¦‚æœå†’å·å‰é¢çš„å€¼ä¸ºç©ºï¼Œåˆ™å–åé¢çš„å€¼ã€‚
      host: ${DS_SERVER:192.168.132.131} 
      port: 8500
      discovery:
        instance-id: ${spring.application.name}-${random.uuid}

#æ­¤é…ç½®ç”¨äºå¥åº·æ£€æŸ¥
management:
  endpoints:
    web:
      exposure:
        include: &quot;*&quot;
  endpoint:
    health:
      show-details: always
</code></pre>
<h3 id="33-ä¿®æ”¹springbootå…¥å£ç±»å¢åŠ æ³¨è§£enablediscoveryclient">3.3 ä¿®æ”¹springbootå…¥å£ç±»ï¼Œå¢åŠ æ³¨è§£<code>@EnableDiscoveryClient</code></h3>
<pre><code class="language-java">@EnableDiscoveryClient
@SpringBootApplication(scanBasePackages = &quot;com.cxlsky&quot;)
@EnableFeignClients(basePackages={&quot;com.cxlsky&quot;})
public class EurekaClientAApplication {

    public static void main(String[] args) {
        SpringApplication.run(EurekaClientAApplication.class, args);
    }

}
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬springé¡¹ç›®å°±æ”¹é€ å®Œæˆäº†ã€‚</p>
<h2 id="å››-consulæœåŠ¡ç«¯çš„å®‰è£…">å››ã€ConsulæœåŠ¡ç«¯çš„å®‰è£…</h2>
<h3 id="41-è¿™é‡Œä½¿ç”¨dockerå®‰è£…å•èŠ‚ç‚¹consul">4.1 è¿™é‡Œä½¿ç”¨dockerå®‰è£…å•èŠ‚ç‚¹consulï¼š</h3>
<pre><code class="language-bash">## 1ã€æœç´¢é•œåƒ
docker search consul
## 2ã€æ‹‰å–é•œåƒ
docker pull consul
## 3ã€è¿è¡Œé•œåƒ
docker run -d -p 18500:8500 --name consul-server consul agent -server -bootstrap -client 0.0.0.0 -ui
## 4ã€æŸ¥çœ‹è¿è¡Œæ—¥å¿—
docker logs -f  consul-server
</code></pre>
<h3 id="42-æŸ¥çœ‹webé¡µé¢">4.2 æŸ¥çœ‹webé¡µé¢</h3>
<figure data-type="image" tabindex="4"><img src="https://imgs.cxlsky.com/image1560850783917.jpg" alt="consulweb.jpg" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ç°åœ¨åªæœ‰consulè‡ªå·±ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸Šå»äº†ï¼Œä¸‹é¢æˆ‘ä»¬å¯åŠ¨æˆ‘ä»¬çš„é¡¹ç›®ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://imgs.cxlsky.com/image1560851191684.jpg" alt="consulclient.jpg" loading="lazy"></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢å¤šå‡ºäº†æˆ‘ä»¬çš„æœåŠ¡ï¼Œè¿™æ ·å°±å®Œæˆäº†æœåŠ¡å‘ç°ã€‚</p>
<blockquote>
<p>ç”±äºæ³¨å†Œä¸­å¿ƒçš„é‡è¦æ€§ï¼Œæˆ‘ä»¬éœ€è¦åšé«˜å¯ç”¨ï¼Œæ‰€ä»¥éœ€è¦é›†ç¾¤éƒ¨ç½²ã€‚åç»­çš„ç« èŠ‚ä¸­æˆ‘ä¼šè®²è§£ä»¥ä¸‹docker swarmï¼Œå¹¶ä¸”ä½¿ç”¨docker swarmå¿«é€Ÿå®Œæˆconsulçš„é›†ç¾¤éƒ¨ç½²ã€‚</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://www.cxlsky.com/post/hello-gridea/</id>
        <link href="https://www.cxlsky.com/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<figure data-type="image" tabindex="1"><img src="https://www.cxlsky.com/post-images/1622708559365.png" alt="" loading="lazy"></figure>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è¿œç¨‹äº‹åŠ¡é…ç½®]]></title>
        <id>https://www.cxlsky.com/post/è¿œç¨‹äº‹åŠ¡ä½¿ç”¨è¯´æ˜/</id>
        <link href="https://www.cxlsky.com/post/è¿œç¨‹äº‹åŠ¡ä½¿ç”¨è¯´æ˜/">
        </link>
        <updated>2018-03-11T01:12:04.000Z</updated>
        <content type="html"><![CDATA[<h2 id="1åœ¨gitä¸‹è½½seata">1.åœ¨gitä¸‹è½½seata</h2>
<p>åœ°å€ï¼š<a href="http://121.5.101.66:8882/city-management/seata.git">http://121.5.101.66:8882/city-management/seata.git</a></p>
<h2 id="2å¯åŠ¨seata">2.å¯åŠ¨:seata</h2>
<p>åœ¨seataæ–‡ä»¶å¤¹ä¸­çš„binæœ‰å¯åŠ¨è„šæœ¬ å¯åŠ¨å°±è¡Œ</p>
<h2 id="3åŠ å…¥ä¾èµ–">3.åŠ å…¥ä¾èµ–</h2>
<pre><code class="language-java">&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h2 id="4åœ¨éœ€è¦è¿œç¨‹äº‹åŠ¡çš„åœ°æ–¹åŠ è½½æ³¨è§£">4.åœ¨éœ€è¦è¿œç¨‹äº‹åŠ¡çš„åœ°æ–¹åŠ è½½æ³¨è§£</h2>
<pre><code class="language-java">@GlobalTransactional
@Override
public void testT() {
    Test1DO aDo = new Test1DO();
    aDo.setName(&quot;123&quot;);
    this.save(aDo);
    Test2DTO dto = new Test2DTO();
    dto.setName(aDo.getName());
    test2Client.add(dto);
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Mybatiså¸¸è§„é…ç½®]]></title>
        <id>https://www.cxlsky.com/post/mybatiså¸¸è§„é…ç½®/</id>
        <link href="https://www.cxlsky.com/post/mybatiså¸¸è§„é…ç½®/">
        </link>
        <updated>2018-02-11T01:12:04.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä¸€-mybatis-configxmlé…ç½®">ä¸€ã€mybatis-config.xmlé…ç½®</h2>
<p>ç”±äºå¼€å‘æ–°é¡¹ç›®ï¼Œéœ€è¦å¯¹mybatisåšé…ç½®ï¼Œè¿™äº›é…ç½®å¯ä»¥æ”¾åœ¨ç³»ç»Ÿçš„ymlæ–‡ä»¶é‡Œï¼Œä¹Ÿå¯ä»¥å•ç‹¬æ”¾åœ¨ä¸€ä¸ªxmlæ–‡ä»¶é‡Œï¼Œæœ¬ç¤ºä¾‹æ”¾åˆ°äº†å•ç‹¬æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;

	&lt;!-- å…¨å±€å‚æ•° --&gt;
	&lt;settings&gt;
		&lt;!-- ä½¿å…¨å±€çš„æ˜ å°„å™¨å¯ç”¨æˆ–ç¦ç”¨ç¼“å­˜ã€‚ --&gt;
		&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot; /&gt;

		&lt;!-- å…¨å±€å¯ç”¨æˆ–ç¦ç”¨å»¶è¿ŸåŠ è½½ã€‚å½“ç¦ç”¨æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå³æ—¶åŠ è½½ã€‚ --&gt;
		&lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot; /&gt;

		&lt;!-- å½“å¯ç”¨æ—¶ï¼Œæœ‰å»¶è¿ŸåŠ è½½å±æ€§çš„å¯¹è±¡åœ¨è¢«è°ƒç”¨æ—¶å°†ä¼šå®Œå…¨åŠ è½½ä»»æ„å±æ€§ã€‚å¦åˆ™ï¼Œæ¯ç§å±æ€§å°†ä¼šæŒ‰éœ€è¦åŠ è½½ã€‚ --&gt;
		&lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;true&quot; /&gt;

		&lt;!-- æ˜¯å¦å…è®¸å•æ¡sql è¿”å›å¤šä¸ªæ•°æ®é›† (å–å†³äºé©±åŠ¨çš„å…¼å®¹æ€§) default:true --&gt;
		&lt;setting name=&quot;multipleResultSetsEnabled&quot; value=&quot;true&quot; /&gt;

		&lt;!-- æ˜¯å¦å¯ä»¥ä½¿ç”¨åˆ—çš„åˆ«å (å–å†³äºé©±åŠ¨çš„å…¼å®¹æ€§) default:true --&gt;
		&lt;setting name=&quot;useColumnLabel&quot; value=&quot;true&quot; /&gt;

		&lt;!-- å…è®¸JDBC ç”Ÿæˆä¸»é”®ã€‚éœ€è¦é©±åŠ¨å™¨æ”¯æŒã€‚å¦‚æœè®¾ä¸ºäº†trueï¼Œè¿™ä¸ªè®¾ç½®å°†å¼ºåˆ¶ä½¿ç”¨è¢«ç”Ÿæˆçš„ä¸»é”®ï¼Œæœ‰ä¸€äº›é©±åŠ¨å™¨ä¸å…¼å®¹ä¸è¿‡ä»ç„¶å¯ä»¥æ‰§è¡Œã€‚ default:false --&gt;
		&lt;setting name=&quot;useGeneratedKeys&quot; value=&quot;false&quot; /&gt;

		&lt;!-- æŒ‡å®š MyBatis å¦‚ä½•è‡ªåŠ¨æ˜ å°„ æ•°æ®åŸºè¡¨çš„åˆ— NONEï¼šä¸éšå°„ PARTIAL:éƒ¨åˆ† FULL:å…¨éƒ¨ --&gt;
		&lt;setting name=&quot;autoMappingBehavior&quot; value=&quot;PARTIAL&quot; /&gt;

		&lt;!-- è¿™æ˜¯é»˜è®¤çš„æ‰§è¡Œç±»å‹ ï¼ˆSIMPLE: ç®€å•ï¼› REUSE: æ‰§è¡Œå™¨å¯èƒ½é‡å¤ä½¿ç”¨prepared statementsè¯­å¥ï¼›BATCH: 
			æ‰§è¡Œå™¨å¯ä»¥é‡å¤æ‰§è¡Œè¯­å¥å’Œæ‰¹é‡æ›´æ–°ï¼‰ --&gt;
		&lt;setting name=&quot;defaultExecutorType&quot; value=&quot;SIMPLE&quot; /&gt;

		&lt;!-- ä½¿ç”¨é©¼å³°å‘½åæ³•è½¬æ¢å­—æ®µã€‚ --&gt;
		&lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot; /&gt;

		&lt;!-- è®¾ç½®æœ¬åœ°ç¼“å­˜èŒƒå›´ session:å°±ä¼šæœ‰æ•°æ®çš„å…±äº« statement:è¯­å¥èŒƒå›´ (è¿™æ ·å°±ä¸ä¼šæœ‰æ•°æ®çš„å…±äº« ) defalut:session --&gt;
		&lt;setting name=&quot;localCacheScope&quot; value=&quot;SESSION&quot; /&gt;

		&lt;!-- è®¾ç½®ä½†JDBCç±»å‹ä¸ºç©ºæ—¶,æŸäº›é©±åŠ¨ç¨‹åº è¦æŒ‡å®šå€¼,default:OTHERï¼Œæ’å…¥ç©ºå€¼æ—¶ä¸éœ€è¦æŒ‡å®šç±»å‹ --&gt;
		&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;NULL&quot; /&gt;
		&lt;setting name=&quot;callSettersOnNulls&quot; value=&quot;true&quot; /&gt;
		&lt;!-- æ˜¾ç¤ºsqlæ—¥å¿— --&gt;
		&lt;!--&lt;setting name=&quot;logImpl&quot; value=&quot;STDOUT_LOGGING&quot; /&gt;--&gt;

	&lt;/settings&gt;
	
&lt;/configuration&gt;
</code></pre>
<h2 id="äºŒ-ç³»ç»Ÿ-applicationyml-é…ç½®">äºŒã€ç³»ç»Ÿ application.yml é…ç½®</h2>
<pre><code class="language-yaml">mybatis-plus:
  config-location: classpath:mybatis/mybatis-config.xml
  mapper-locations: classpath*:mapper/*.xml
</code></pre>
]]></content>
    </entry>
</feed>